<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <span>Employee Name:</span>
    <input list="employee" name="employees" onchange="google.script.run.withSuccessHandler(employeeShift).getShift(this.value)">
    <datalist id="employee"></datalist>
    <p id="shift" style="display: none;"></p>
    <label for='newShift' style="display: none;">New Shift:</label>
    <select id="newShift" style="display: none;"></select>
    <button id='formSubmit' type='button' onclick='submit' style="display: none;">Submit</button>
    <script>
      google.script.run.withSuccessHandler(employeeNames).getNames();
      google.script.run.withSuccessHandler(shiftNames).getShiftNames();
      
      function shiftNames(names) {
        var select = document.getElementById('newShift');
        
        names.forEach(function (name) {
          if (name[0] !== "") {
            var option = document.createElement('option');
            option.value = name;
            option.innerHTML = name;
            select.appendChild(option);
          }
        });
      }
      
      function employeeNames(names) {
        names.forEach(function (name) {
          var option = document.createElement('option');
          option.value = name;
          document.getElementById('employee').appendChild(option);
        });        
      }

      function employeeShift(shift) {
        var span = document.getElementById('shift');
        span.innerHTML = "Current Shift: " + shift;
        
        span.style.display = 'block';
        document.getElementsByTagName('label')[0].style.display = 'block';
        document.getElementById('newShift').style.display = 'block';
        document.getElementById('formSubmit').style.display = 'block';            
      }
    </script>
  </body>
</html>


